# Отчёт по лабораторной работе №1 по теме "Точечные фильтры"

## Введение
Перед нами стояли 3 основные задачи, требовавшие выполнения:
* реализация прямого/обратного перевода между цветовыми моделями
* реализация фильтра "___Увеличение яркости___" для разных цветовых моделей
* замеры времени и качества обработки

## Теоретическая информация
В качестве цветовых моделей мы взяли ___BGR $⇆$ YCrCb___, а в качестве метрики сходства - ___PSNR___
### _Рассмотим прямой/обратный перевод изображения из цветовой модели __BGR__ в цветовую модель __YCrCb__._
__YCrCb__ - цветовое пространство, которое используется для передачи цветных изображений в компонентном видео и цифровой фотографии.
__Y__ — компонента яркости, __Cr__ и __Cb__ являются красной и синей цветоразностными компонентами соответсвенно.

Для переводов используют следующие формулы преобразования ($Δ = 128$, т.к. работаем с $8$-битными изображениями):

* ___RGB $⟶$ YCrCb___:
$$
\left\{
    \begin{array}{ll}
    Y = 0.299 * R + 0.587 * G + 0.114 * B \\
    Cr = (R - Y) * 0.713 \ + \ Δ \\
    Cb = (B - Y) * 0.564 \ + \ Δ \\
    \end{array}
\right.
$$

* ___YCrCb $⟶$ RGB___:
$$
\left\{
    \begin{array}{ll}
    R = Y + 1.403 * (Cr - Δ) \\
    G = Y - 0.714 * (Cr - Δ) - 0.344 * (Cb - Δ) \\
    B = Y + 1.773 * (Cb - Δ) \\
    \end{array}
\right.
$$

### _Рассмотрим фильтр "___Увеличение яркости___"._
Это __точечный__ фильтр, поэтому операция, лежащая в его основе, применяется к каждому пискелю. Само правило фильтрации зависит от выбора цветовой модели изображения:

* для цветовой модели __BGR__ в качестве правила фильтрации было взято следующее преобразование ($С = const$):
$$
\left\{
    \begin{array}{ll}
    R' = \max\{\min\{R + С, \ 255\}, \ 0\} \\
    G' = \max\{\min\{G + С, \ 255\}, \ 0\} \\
    B' = \max\{\min\{B + С, \ 255\}, \ 0\} \\
    \end{array}
\right.
$$

* так как в цветовой модели __YCrCb__ компонента __Y__ отвечает за яркость, то достаточно увеличить только её оставив две другие неизменными, и тогда в качестве правила фильтрации можно взять следующее преобразование ($С = const$):
$$
\left\{
    \begin{array}{ll}
    Y' = \max\{\min\{Y + С, \ 255\}, \ 0\} \\
    Cr' = Cr \\
    Cb' = Cb \\
    \end{array}
\right.
$$

На основе формул преобразования можно сделать вывод, что применение фильтра "___Увеличение яркости___" к изображению в цветовой модели __YCrCb__ будет выполняться в $3$ раза быстрее, чем применение фильтра к тому же изображению в __BGR__ представлении.

### _Рассмотрим метрику ___PSNR___._
Предположим мы сравниваем $2$ изображения ($X$ и $Y$) с одинаковыми высотой ($H$) и шириной ($W$).
Сначала найдём ___MSE___:

$$
MSE = \frac{1}{3HW} \sum\limits_{i=1}^{H} \sum\limits_{j=1}^{W} \|x_{ij} - y_{ij}\|^2 \ , \\

где \ \ x_{ij} = (B_x, G_x, R_x)^T, \ y_{ij} = (B_y, G_y, R_y)^T
$$

Теперь найдём ___PSNR___ ($M$ - максимальное значение, т.е. $M = 255$, т.к. $8$-битное изображение):
$$
PSNR = 10\lg\frac{M^2}{MSE} \\
$$

## Результаты замеров качества и времени выполнения

...

## Выводы
В ходе выполнения лабораторной работы нами были изучены основние идеи, 
лежащие в основе точечных фильтров и преобразобаний цветовых моделей, на примере реализации точечного фильтра "__Увеличение яркости__" и прямого/обратного перевода изображения из цветовой модели __BGR__ в цветовую модель __YCrCb__. А также были проведены замеры времени применения точечного фильтра "__Увеличение яркости__" к изображению в различных цветовых пространствах, тем самым подтвердив эмперическое предположение о $3$-х кратном увеличении скорости выполнения при работе с __YCrCb__ представлением изображения.